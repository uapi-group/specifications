<!doctype html><html lang=en dir=ltr><head><meta name=generator content="Hugo 0.104.3"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Configuration Files Specification # Introduction # Various specifications attempt to define configuration files and file formats. This specification establishes where these files should be looked for, in which order, and how precedence, masking, extensions and overrides work.
The purpose of the rules defined here is to allow OS vendors to implement the hermetic-usr pattern, where all vendor files are shipped in the vendor tree itself (/usr/), including configuration files with system defaults, while allowing local or vendor overrides without modifying the original files, for easier management."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Configuration Files Specification"><meta property="og:description" content="Configuration Files Specification # Introduction # Various specifications attempt to define configuration files and file formats. This specification establishes where these files should be looked for, in which order, and how precedence, masking, extensions and overrides work.
The purpose of the rules defined here is to allow OS vendors to implement the hermetic-usr pattern, where all vendor files are shipped in the vendor tree itself (/usr/), including configuration files with system defaults, while allowing local or vendor overrides without modifying the original files, for easier management."><meta property="og:type" content="article"><meta property="og:url" content="https://uapi-group.org/specifications/specs/configuration_files_specification/"><meta property="article:section" content="specs"><title>Configuration Files Specification | UAPI Group Specifications</title><link rel=manifest href=/specifications/manifest.json><link rel=icon href=/specifications/favicon.png type=image/x-icon><link rel=stylesheet href=/specifications/book.min.f716a89e40b01f033146ee402497165ac5bcf8935948094dceafbcb19f6f3c8d.css integrity="sha256-9xaonkCwHwMxRu5AJJcWWsW8+JNZSAlNzq+8sZ9vPI0="><script defer src=/specifications/en.search.min.3b29559ecba2808ae48c5c6fd304b5b1c1700c0b84976d07efa39f933831fcb5.js integrity="sha256-OylVnsuigIrkjFxv0wS1scFwDAuEl20H76Ofkzgx/LU="></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a href=/specifications><span>UAPI Group Specifications</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://uapi-group.org/>⬅️ Back to top</a></li><li>⸻</li></ul><ul><li><span>Specs</span><ul><li><a href=https://uapi-group.org/specifications/specs/sysext/>Sysext</a></li><li><a href=https://uapi-group.org/specifications/specs/boot_loader_specification/>Boot Loader Specification</a></li><li><a href=https://uapi-group.org/specifications/specs/configuration_files_specification/ class=active>Configuration Files Specification</a></li><li><a href=https://uapi-group.org/specifications/specs/discoverable_disk_image/>Discoverable Disk Image</a></li><li><a href=https://uapi-group.org/specifications/specs/discoverable_partitions_specification/>Discoverable Partitions Specification</a></li><li><a href=https://uapi-group.org/specifications/specs/extension_image/>Extension Images</a></li><li><a href=https://uapi-group.org/specifications/specs/file_hierarchy_for_the_verification_of_os_artifacts/>File Hierarchy for the Verification of OS Artifacts (VOA)</a></li><li><a href=https://uapi-group.org/specifications/specs/linux_file_system_hierarchy/>Linux File System Hierarchy</a></li><li><a href=https://uapi-group.org/specifications/specs/linux_tpm_pcr_registry/>Linux TPM PCR Registry</a></li><li><a href=https://uapi-group.org/specifications/specs/unified_kernel_image/>Unified Kernel Image</a></li><li><a href=https://uapi-group.org/specifications/specs/version_format_specification/>Version Format Specification</a></li></ul></li></ul><ul><li>⸻</li><li><a href=https://github.com/uapi-group/specifications target=_blank rel=noopener>Collaborate on Github</a></li></ul></nav><script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/specifications/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Configuration Files Specification</strong>
<label for=toc-control><img src=/specifications/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#storage-directories-and-overrides>Storage Directories and Overrides</a></li><li><a href=#masking>Masking</a></li><li><a href=#drop-ins>Drop-ins</a><ul><li><a href=#drop-ins-without-main-configuration-file>Drop-ins without Main Configuration File</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=configuration-files-specification>Configuration Files Specification
<a class=anchor href=#configuration-files-specification>#</a></h1><h2 id=introduction>Introduction
<a class=anchor href=#introduction>#</a></h2><p>Various specifications attempt to define configuration files and file formats. This
specification establishes where these files should be looked for, in which
order, and how precedence, masking, extensions and overrides work.</p><p>The purpose of the rules defined here is to allow OS vendors to implement the
hermetic-usr pattern, where all vendor files are shipped in the vendor tree itself
(<code>/usr/</code>), including configuration files with system defaults, while allowing local
or vendor overrides without modifying the original files, for easier management. This is
especially beneficial for image-based deployments, where the vendor tree is read-only.</p><p>These rules are derived from existing real-world usage from the
<a href=https://github.com/systemd/systemd>systemd
project</a> and the
<a href=https://github.com/openSUSE/libeconf>libeconf
project</a>. It is highly recommended to use libeconf,
which is readily available and maintained in all major distributions, rather than
reimplementing this specification locally.</p><p>This specification is agnostic toward the actual format and content of the configuration
files, the precise path used under each top-level hierarchy, and also toward the
filenames and extensions, with the exception of the <code>.d/</code> notation for drop-ins
directories. It is strongly encouraged to enforce a specific suffix for the configuration
files, in order to disambiguate (e.g.: with backup files), but the choice of which suffix
to use is left to each implementation.</p><h2 id=storage-directories-and-overrides>Storage Directories and Overrides
<a class=anchor href=#storage-directories-and-overrides>#</a></h2><p>In order to allow shipping system defaults owned by the OS vendor, while at the same
time letting local users or admins override those defaults, <code>/usr/</code> and <code>/etc/</code> are both
supported for storage of configuration files, with the latter having higher priority.
The precise location under <code>/usr/</code> is left open for the implementation to decide - it
could be hard-coded to <code>/usr/lib/</code> or it could be left to each application to pick from
various options, such as <code>/usr/share/</code> or <code>/usr/etc/</code>.
Programs must work correctly if no configuration files are found in <code>/etc/</code>.
Optionally, <code>/run/</code> is also supported for ephemeral overrides.</p><p>For example, <code>/usr/lib/foo/bar.conf</code> provides the default configuration file.
If <code>/run/foo/bar.conf</code> is present and supported, it would take precedence over
<code>/usr/lib/foo/bar.conf</code>.
Finally, a user can create <code>/etc/foo/bar.conf</code> which would take precedence and
completely override both.</p><h2 id=masking>Masking
<a class=anchor href=#masking>#</a></h2><p>As a special override case, it must be possible to mask files across different
locations by creating a symlink to <code>/dev/null</code> or an empty file.</p><p>For example, an empty <code>/etc/foo/bar.conf</code> means that <code>/usr/lib/foo/bar.conf</code> is
masked and thus not parsed.</p><h2 id=drop-ins>Drop-ins
<a class=anchor href=#drop-ins>#</a></h2><p>All configuration paths must support drop-ins,
except for configuration file formats where automatic combining of multiple files is not feasible,
for example scripts or structured documents.
Supporting drop-ins means that in addition to parsing a full configuration file,
an implementation also parses the drop-in files in the drop-in directories associated with it.</p><p>Drop-ins always have higher precedence than the configuration file they refer to.
Drop-ins are sorted in the lexicographic order using the file name without the path,
regardless of the hierarchy under which they are stored.
The drop-ins that are later in this order have higher precedence.</p><p>Considering the following files are present on the filesystem, this would be the order in which the
files are parsed. Note, that files with the same name override each other. The configuration in
<code>bar.conf</code> has the lowest priority, and is read before <code>a.conf</code> and <code>b.conf</code>. <code>b.conf</code> has the
highest priority:</p><ul><li><del><code>/usr/lib/foo/bar.conf</code></del> (overridden by <code>/etc/foo/bar.conf</code>)</li><li><code>/etc/foo/bar.conf</code></li><li><del><code>/usr/lib/foo/bar.conf.d/a.conf</code></del> (overridden by <code>/etc/foo/bar.conf.d/a.conf</code>)</li><li><code>/etc/foo/bar.conf.d/a.conf</code></li><li><code>/usr/lib/foo/bar.conf.d/b.conf</code></li></ul><p>If a config file is masked, drop-ins must still be parsed, unless they are masked
themselves.</p><p>For example, even if <code>/usr/lib/foo/bar.conf</code> is masked by an empty <code>/etc/foo/bar.conf</code>,
<code>/usr/lib/foo/bar.conf.d/a.conf</code> must still be parsed and applied, unless there is also
an empty <code>/etc/foo/bar.conf.d/a.conf</code>, in which case the drop-in is masked too.</p><p>Drop-ins are not recursive, so a drop-in cannot have a directory of drop-ins.</p><p>For example, <code>/etc/foo/bar.conf.d/a.conf</code> cannot be overridden by
<code>/etc/foo/bar.conf.d/a.conf.d/b.conf</code>, and the latter must be ignored if it exists.</p><h3 id=drop-ins-without-main-configuration-file>Drop-ins without Main Configuration File
<a class=anchor href=#drop-ins-without-main-configuration-file>#</a></h3><p>Optionally, schemes with only drop-ins, without a &lsquo;main&rsquo; configuration file, should also
be supported by implementations. In such schemes many drop-ins are loaded from a common
directory in each hierarchy.</p><p>For example, <code>/usr/lib/foo.d/a.conf</code>, <code>/usr/lib/foo.d/b.conf</code> and <code>/etc/foo.d/c.conf</code>
are all loaded and parsed in this scheme, in this order.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/uapi-group/specifications/edit/main/specs/configuration_files_specification.md target=_blank rel=noopener><img src=/specifications/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#storage-directories-and-overrides>Storage Directories and Overrides</a></li><li><a href=#masking>Masking</a></li><li><a href=#drop-ins>Drop-ins</a><ul><li><a href=#drop-ins-without-main-configuration-file>Drop-ins without Main Configuration File</a></li></ul></li></ul></nav></div></aside></main></body></html>
<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="UAPI.15 OSC 3008: Hierarchical Context Signalling# Version Changes 1.0 Initial release A terminal connects a user with programs. Control of the program side of terminals is typically passed around to various different components while the user is active: a shell might pass control to a process it invokes. If that process is systemd’s run0 then primary control is passed to the privileged session of the target user. If systemd-nspawn is then invoked to start a container, primary control is passed to that container, and so on.
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://uapi-group.org/specifications/specs/osc_context/"><meta property="og:site_name" content="UAPI Group Specifications"><meta property="og:title" content="UAPI.15 OSC 3008: Hierarchical Context Signalling"><meta property="og:description" content="UAPI.15 OSC 3008: Hierarchical Context Signalling# Version Changes 1.0 Initial release A terminal connects a user with programs. Control of the program side of terminals is typically passed around to various different components while the user is active: a shell might pass control to a process it invokes. If that process is systemd’s run0 then primary control is passed to the privileged session of the target user. If systemd-nspawn is then invoked to start a container, primary control is passed to that container, and so on."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="specs"><meta itemprop=name content="UAPI.15 OSC 3008: Hierarchical Context Signalling"><meta itemprop=description content="UAPI.15 OSC 3008: Hierarchical Context Signalling# Version Changes 1.0 Initial release A terminal connects a user with programs. Control of the program side of terminals is typically passed around to various different components while the user is active: a shell might pass control to a process it invokes. If that process is systemd’s run0 then primary control is passed to the privileged session of the target user. If systemd-nspawn is then invoked to start a container, primary control is passed to that container, and so on."><meta itemprop=wordCount content="1850"><title>UAPI.15 OSC 3008: Hierarchical Context Signalling | UAPI Group Specifications</title><link rel=icon href=/specifications/favicon.png><link rel=manifest href=/specifications/manifest.json><link rel=canonical href=https://uapi-group.org/specifications/specs/osc_context/><link rel=stylesheet href=/specifications/book.min.6e0e4905af9f431e4a07d14b16ee4d5d1e90da19ad2b6d9d1d2aa2da9757473d.css integrity="sha256-bg5JBa+fQx5KB9FLFu5NXR6Q2hmtK22dHSqi2pdXRz0=" crossorigin=anonymous><script defer src=/specifications/fuse.min.js></script><script defer src=/specifications/en.search.min.be5215689e749d75b590d2a64f122aa0b6e9bbcae69b23f0189eac61dd217537.js integrity="sha256-vlIVaJ50nXW1kNKmTxIqoLbpu8rmmyPwGJ6sYd0hdTc=" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-specs book-layout-default"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/specifications/><span>UAPI Group Specifications</span></a></h2><div class="book-search hidden"><input id=book-search-input type=text placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/>⬅️ Back to top</a></li></ul><ul><li><a>Specifications</a><ul><li><a href=/specifications/specs/boot_loader_specification/>UAPI.1 Boot Loader Specification</a></li><li><a href=/specifications/specs/discoverable_partitions_specification/>UAPI.2 Discoverable Partitions Specification</a></li><li><a href=/specifications/specs/discoverable_disk_image/>UAPI.3 Discoverable Disk Images</a></li><li><a href=/specifications/specs/extension_image/>UAPI.4 Extension Images</a></li><li><a href=/specifications/specs/unified_kernel_image/>UAPI.5 Unified Kernel Images</a></li><li><a href=/specifications/specs/configuration_files_specification/>UAPI.6 Configuration Files Specification</a></li><li><a href=/specifications/specs/linux_tpm_pcr_registry/>UAPI.7 Linux TPM PCR Registry</a></li><li><a href=/specifications/specs/package_metadata_for_executable_files/>UAPI.8 Package Metadata for Executable Files</a></li><li><a href=/specifications/specs/linux_file_system_hierarchy/>UAPI.9 Linux File System Hierarchy</a></li><li><a href=/specifications/specs/version_format_specification/>UAPI.10 Version Format Specification</a></li><li><a href=/specifications/specs/file_hierarchy_for_the_verification_of_os_artifacts/>UAPI.11 File Hierarchy for the Verification of OS Artifacts (VOA)</a></li><li><a href=/specifications/specs/elf_dlopen_metadata/>UAPI.12 dlopen() Metadata for ELF Files</a></li><li><a href=/specifications/specs/vmclock/>UAPI.13 VMClock</a></li><li><a href=/specifications/specs/vmgenid/>UAPI.14 VMGenID</a></li><li><a href=/specifications/specs/osc_context/ class=active>UAPI.15 OSC 3008: Hierarchical Context Signalling</a></li></ul></li></ul><ul><li><a href=https://github.com/uapi-group/specifications target=_blank rel=noopener>Collaborate on Github</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/specifications/icons/menu.svg class=book-icon alt=Menu></label><h3>UAPI.15 OSC 3008: Hierarchical Context Signalling</h3><label for=toc-control><img src=/specifications/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class=hidden><nav id=TableOfContents><ul><li><a href=#use-cases>Use Cases</a></li><li><a href=#context-types>Context Types</a></li><li><a href=#semantics>Semantics</a></li><li><a href=#general-syntax>General Syntax</a></li><li><a href=#metadata-fields>Metadata Fields</a></li><li><a href=#processing-limits-security>Processing, Limits, Security</a></li><li><a href=#examples>Examples</a></li><li><a href=#syntax-in-abnf>Syntax in ABNF</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=uapi15-osc-3008-hierarchical-context-signalling>UAPI.15 OSC 3008: Hierarchical Context Signalling<a class=anchor href=#uapi15-osc-3008-hierarchical-context-signalling>#</a></h1><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>1.0</td><td>Initial release</td></tr></tbody></table><p>A terminal connects a user with programs. Control of the program side of
terminals is typically passed around to various different components while the
user is active: a shell might pass control to a process it invokes. If that
process is systemd&rsquo;s <code>run0</code> then primary control is passed to the privileged session of
the target user. If <code>systemd-nspawn</code> is then invoked to start a container, primary
control is passed to that container, and so on.</p><p>A terminal emulator might be interested to know which component is currently in
primary control of the program side of a terminal. OSC 3008 is a mechanism to
inform it about such contexts. Each component taking over control can inform
the terminal emulators that a new context begins now, and then use the terminal
or pass control down to further apps, which can introduce contexts. Each
context may carry various descriptive metadata fields.</p><h2 id=use-cases>Use Cases<a class=anchor href=#use-cases>#</a></h2><p>Terminal emulators can use hierarchical context information:</p><ol><li><p>To introduce markers/bookmarks in the output that the user can jump between.</p></li><li><p>To visually identify output from different contexts. For example the
background of the associated output can be tinted in a reddish tone when
privileges are acquired, and similar.</p></li><li><p>Meta information on specific output can be shown in a tooltip or similar</p></li><li><p>Programs (and all subcontexts) can be killed via a right-click menu on the
output they generate.</p></li><li><p>Similar, a right-click menu might offer an item to offer opening a new
interactive shell in the same working directory that was current on the
selected context.</p></li><li><p>Failed commands or aborted sessions can be marked requesting user attention.</p></li><li><p>A &ldquo;breadcrumb&rdquo; style display can be implementing shown the nesting of contexts to the user.</p></li></ol><h2 id=context-types>Context Types<a class=anchor href=#context-types>#</a></h2><p>There are various types of contexts defined by this specification:</p><ol><li><p><code>boot</code> → a booted system initiates this context early at boot. (systemd&rsquo;s
PID 1 generates this on <code>/dev/console</code>.)</p></li><li><p><code>container</code> → a container manager initialized an interactive connection to a
container. (<code>systemd-nspawn</code> generates this when interactively invoking a
container. <code>machinectl login</code>, <code>machinectl shell</code> do this too.)</p></li><li><p><code>vm</code> → a VM manager initialized a terminal connection to a
VM. (<code>systemd-vmspawn</code> generates this when interactively invoking a VM, as
one example.)</p></li><li><p><code>elevate</code> → when the user interactively acquired higher privileges. (<code>run0</code>
initiates a context of this type whenever the user invokes it to acquire
root privileges.)</p></li><li><p><code>chpriv</code> → similar, but when the user acquired <em>different</em> privileges, not
necessarily higher ones. (<code>run0</code> initiates a context of this type whenever
the user invokes it to acquire non-root privileges of another user.)</p></li><li><p><code>subcontext</code> → similar, but the source and target privileges where
identical. (<code>run0</code> initiates a context of this type whenever the user
invokes it to acquire privileges of the user itself.)</p></li><li><p><code>remote</code> → a user invoked a tool such as <code>ssh</code> to connect to a remote
system.</p></li><li><p><code>shell</code> → an interactive terminal shell initiates this context</p></li><li><p><code>command</code> → a shell interactively invokes a new program.</p></li><li><p><code>app</code> → an interactive program may initiate this context.</p></li><li><p><code>service</code> → the service manager invokes an interactive service on the terminal</p></li><li><p><code>session</code> → a login session of the user is initialized.</p></li></ol><h2 id=semantics>Semantics<a class=anchor href=#semantics>#</a></h2><p>Contexts in the sense of OSC 3008 are hierarchical, and describe a tree
structure: whenever a new context is opened it becomes the new active context,
and the previously active context becomes its parent (if there is one). Only
one context is currently active, but previously opened contexts remain valid in
the background. Any other data written or read should be considered associated
with the currently active context.</p><p>Each context carries an identifier, chosen by the component opening the
context. The identifier can chosen freely, but must not be longer than 64
characters. The characters may be in the 32…126 byte range. Identifiers should
be universally unique, for example randomly generated. A freshly generated UUID
would work well for this, but this could also be something like the Linux boot
ID combined with the 64bit inode number of Linux pidfds, or something hashed
from it.</p><p>Fundamentally, there are two OSC 3008 commands defined:</p><ol><li><p>OSC &ldquo;<code>3008;start=</code>&rdquo; … (the <em>start sequence</em>) → this initiates, updates or
indicates a return to a context. It carries a context identifier, and
typically some metadata. This may be sent to first initiate a context. If
sent again for the same context ID that was initiated already this indicates
an update of the existing context. In this case, <em>any</em> previously set
metadata fields for the context are flushed out, reset to their defaults,
and then reinitialized from the newly supplied data. Also, in this case any
subcontexts of the contexts are implicitly terminated.</p></li><li><p>OSC &ldquo;<code>3008;end=</code>&rdquo; … (the <em>end sequence</em>) → this terminates a context. It
carries a context identifier to close, initiated before with OSC
&ldquo;<code>3008;start=</code>&rdquo;. It may also carry additional metadata.</p></li></ol><h2 id=general-syntax>General Syntax<a class=anchor href=#general-syntax>#</a></h2><p>This builds on ECMA-48, and reuses the OSC and ST concepts introduced there.</p><p>For sequences following this specification it is recommended to encode OSC as
0x1B 0x5D, and ST as 0x1B 0x5C.</p><p>ECMA-48 only allows characters from the range 0x20…0x7e (i.e. 32…126) inside
OSC sequences. However, most terminal emulators nowadays allow the ASCII byte
range > 0x7f in the OSC sequences they process, and so does this
specification. Control characters (&lt; 0x20 and 0x7f) are not allowed. The
semicolon character ("<code>;</code>") – which is used as field separator by this
specification – shall be replaced by &ldquo;<code>\x3b</code>&rdquo; and the backslash character
("<code>\</code>") shall be replaced by &ldquo;<code>\x5c</code>&rdquo;. All textual fields must be encoded in
UTF-8, and then escaped with these two replacements.</p><p>The start sequence begins with OSC, followed by the string <code>3008;start=</code>,
followed by the context ID. This is then followed by any number of metadata
fields, including none. Metadata fields begin with a semicolon (<code>;</code>) followed
by in a string identifying the type of field, followed by an equal sign (<code>=</code>),
and the field value. The sequence ends in ST.</p><p>The end sequence begins with OSC, followed by the string <code>3008;end=</code>, followed
by the context ID, and a series of metadata fields in the same syntax as for
the start sequence. The sequence ends in ST.</p><h2 id=metadata-fields>Metadata Fields<a class=anchor href=#metadata-fields>#</a></h2><p>The following fields are currently defined for the start sequence:</p><table><thead><tr><th>Field</th><th>Context Types</th><th>Description</th></tr></thead><tbody><tr><td><code>type=</code></td><td><em>all</em></td><td>Declares the context type, one of the types described above</td></tr><tr><td><code>user=</code></td><td><em>all</em></td><td>UNIX user name the process issuing the sequence runs as</td></tr><tr><td><code>hostname=</code></td><td><em>all</em></td><td>UNIX host name of the system the process issuing the sequence runs on</td></tr><tr><td><code>machineid=</code></td><td><em>all</em></td><td>The machine ID (i.e. <code>/etc/machine-id</code>) of the system the process issuing the sequence runs on</td></tr><tr><td><code>bootid=</code></td><td><em>all</em></td><td>The boot ID (i.e. <code>/proc/sys/kernel/random/boot_id</code>) of the system the process issuing the sequence runs on</td></tr><tr><td><code>pid=</code></td><td><em>all</em></td><td>The numeric PID of the process issuing the sequence, in decimal notation</td></tr><tr><td><code>pidfdid=</code></td><td><em>all</em></td><td>The 64bit inode number of the pidfd of the process issuing the sequence, in decimal notation</td></tr><tr><td><code>comm=</code></td><td><em>all</em></td><td>The process name (i.e. <code>/proc/$PID/comm</code>, <code>PR_GET_NAME</code>) of the process issuing the sequence</td></tr><tr><td><code>cwd=</code></td><td><code>shell</code>, <code>command</code></td><td>The current working directory</td></tr><tr><td><code>cmdline=</code></td><td><code>command</code></td><td>The full command line of the invoked command</td></tr><tr><td><code>vm=</code></td><td><code>vm</code></td><td>The name of the VM being invoked</td></tr><tr><td><code>container=</code></td><td><code>container</code></td><td>The name of the container being invoked</td></tr><tr><td><code>targetuser=</code></td><td><code>elevate</code>, <code>chpriv</code>, <code>vm</code>, <code>container</code>, <code>remote</code>, <code>session</code></td><td>Target UNIX user name</td></tr><tr><td><code>targethost=</code></td><td><code>remote</code></td><td>Target UNIX, DNS host name, or IP address</td></tr><tr><td><code>sessionid=</code></td><td><code>session</code></td><td>New allocated session ID</td></tr></tbody></table><p>The following fields are currently defined for the end sequence:</p><table><thead><tr><th>Field</th><th>Context Types</th><th>Description</th></tr></thead><tbody><tr><td><code>exit=</code></td><td><code>command</code></td><td>One of <code>success</code>, <code>failure</code>, <code>crash</code>, <code>interrupt</code>, indicating how the program terminated</td></tr><tr><td><code>status=</code></td><td><code>command</code></td><td>The command&rsquo;s numeric exit status, i.e. the 0…255 value a program returns</td></tr><tr><td><code>signal=</code></td><td><code>command</code></td><td>The termination signal of the command, if it died abnormally. A symbolic signal name. (<code>SIGKILL</code>, …)</td></tr></tbody></table><p>All fields are optional, including the context type. However, it is generally
recommended to always include the first 7 fields listed above, to make it easy
to pinpoint the origin of a context in a race-free fashion, without any
ambiguities.</p><p>The order of the metadata fields is undefined, they may appear in any order
(including that <code>type=</code> is specified at the very end or in the middle!). Note
that <code>start=</code> and <code>end=</code> are not considered metadata fields but part of the
start sequence, and hence must always appear right after OSC.</p><h2 id=processing-limits-security>Processing, Limits, Security<a class=anchor href=#processing-limits-security>#</a></h2><p>All context information provided like this should be considered auxiliary and –
to some degree – redundant information. Hence, it would be wise for a terminal
to enforce limits on various resources, dropping additional data once these
limits are hit. Most importantly, a maximum stacking depth should probably
enforced: any attempts to initiate further contexts should be ignored once the
stack limit is hit (i.e. the earlier contexts should be kept, the later
contexts be discarded, not the opposite). Overly long fields should be
discarded (or potentially truncated, depending on the field type). This
specification does not recommend any specific stack or string limits for now.</p><p>The usual terminal reset sequences should <em>not</em> affect the stack of contexts
(this is a safety feature: a program down the stack should not be able to
affect the stack further up, possibly hiding relevant information). A temporary
TTY hangup (<code>vhangup()</code>) should result in a full reset of the stack.</p><p>All provided data should be processed in a lenient, graceful fashion: if a
sequence contains invalid fields, those fields should be ignored, but the rest
of the fields should still be used. In particular, unknown fields should be
ignored.</p><p>The fields provided in these sequences should not contain sensitive
information. Context IDs should not be considered confidential, but it is
strongly recommended to generate them in a fashion that guarantees their
sufficient uniqueness and avoids accidental or intended clashes with other
contents.</p><h2 id=examples>Examples<a class=anchor href=#examples>#</a></h2><ol><li><p>A new container <code>foobar</code> has been invoked by user <code>lennart</code> on host <code>zeta</code>:
<code>OSC "3008;start=bed86fab93af4328bbed0a1224af6d40;type=container;user=lennart;hostname=zeta;machineid=3deb5353d3ba43d08201c136a47ead7b;bootid=d4a3d0fdf2e24fdea6d971ce73f4fbf2;pid=1062862;pidfdid=1063162;comm=systemd-nspawn;container=foobar" ST</code></p></li><li><p>This context ends: <code>OSC "3008;end=bed86fab93af4328bbed0a1224af6d40" ST</code></p></li></ol><h2 id=syntax-in-abnf>Syntax in ABNF<a class=anchor href=#syntax-in-abnf>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-abnf data-lang=abnf><span style=display:flex><span><span style=color:#a6e22e>OSC</span>          <span style=color:#f92672>=</span> <span style=color:#ae81ff>%x1B</span> <span style=color:#ae81ff>%x5D</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ST</span>           <span style=color:#f92672>=</span> <span style=color:#ae81ff>%x1B</span> <span style=color:#ae81ff>%x5C</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>DECIMAL</span>      <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;0&#34;</span>-<span style=color:#ae81ff>&#34;9&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>HEX</span>          <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;0&#34;</span>-<span style=color:#ae81ff>&#34;9&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;A&#34;</span>-<span style=color:#ae81ff>&#34;F&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;a-f&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ID128</span>        <span style=color:#f92672>=</span> <span style=color:#f92672>32*36</span>(<span style=color:#a6e22e>HEX</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;-&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>UINT64</span>       <span style=color:#f92672>=</span> <span style=color:#f92672>1*20</span><span style=color:#a6e22e>DECIMAL</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ESCSEMICOLON</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;\x3b&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ESCBACKSLASH</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;\x5c&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SAFE</span>         <span style=color:#f92672>=</span> <span style=color:#ae81ff>%x20-3a</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>%x3c-5b</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>%x5d-7e</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>ESCSEMICOLON</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>ESCBACKSLASH</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>CTXID</span>        <span style=color:#f92672>=</span> <span style=color:#f92672>1*64</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TYPEENUM</span>     <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;service&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;session&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;shell&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;command&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;vm&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;container&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;elevate&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;chpriv&#34;</span>  <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;subcontext&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;remote&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;boot&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;app&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TYPE</span>         <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;type=&#34;</span> <span style=color:#a6e22e>TYPEENUM</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>USER</span>         <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;user=&#34;</span> <span style=color:#f92672>1*255</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>HOSTNAME</span>     <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;hostname=&#34;</span> <span style=color:#f92672>1*255</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>MACHINEID</span>    <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;machineid=&#34;</span> <span style=color:#f92672>1</span><span style=color:#a6e22e>D128</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>BOOTID</span>       <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;bootid=&#34;</span> <span style=color:#a6e22e>ID128</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PID</span>          <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;pid=&#34;</span> <span style=color:#a6e22e>UINT64</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PIDFDID</span>      <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;pidfdid=&#34;</span> <span style=color:#a6e22e>UINT64</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>COMM</span>         <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;comm=&#34;</span> <span style=color:#f92672>1*255</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>CWD</span>          <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;cwd=&#34;</span> <span style=color:#f92672>1*255</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>CMDLINE</span>      <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;cmdline=&#34;</span> <span style=color:#f92672>*255</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>VM</span>           <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;vm=&#34;</span> <span style=color:#f92672>1*255</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>CONTAINER</span>    <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;container=&#34;</span> <span style=color:#f92672>1*255</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TARGETUSER</span>   <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;targetuser=&#34;</span> <span style=color:#f92672>1*255</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>TARGETHOST</span>   <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;targethost=&#34;</span> <span style=color:#f92672>1*255</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SESSIONID</span>    <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;sessionid=&#34;</span> <span style=color:#f92672>1*255</span><span style=color:#a6e22e>SAFE</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>STARTFIELD</span>   <span style=color:#f92672>=</span> <span style=color:#a6e22e>TYPE</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>USER</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>HOSTNAME</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>MACHINEID</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>BOOTID</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>PID</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>PIDFDID</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>COMM</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>CWD</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>CMDLINE</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>VM</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>CONTAINER</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>TARGETUSER</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>TARGETHOST</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>SESSIONID</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>STARTSEQ</span>     <span style=color:#f92672>=</span> <span style=color:#a6e22e>OSC</span> <span style=color:#ae81ff>&#34;3008;start=&#34;</span> <span style=color:#a6e22e>CTXID</span> <span style=color:#f92672>*</span>(<span style=color:#ae81ff>&#34;;&#34;</span> <span style=color:#a6e22e>STARTFIELD</span>) <span style=color:#a6e22e>ST</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>EXITENUM</span>     <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;success&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;failure&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;crash&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;interrupt&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SIGNALENUM</span>   <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;SIGBUS&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;SIGTRAP&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;SIGABRT&#34;</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>&#34;SIGSEGV&#34;</span> <span style=color:#f92672>/</span> …
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>EXIT</span>         <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;exit=&#34;</span> <span style=color:#a6e22e>EXITENUM</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>STATUS</span>       <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;status=&#34;</span> <span style=color:#a6e22e>UINT64</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SIGNAL</span>       <span style=color:#f92672>=</span> <span style=color:#ae81ff>&#34;signal=&#34;</span> <span style=color:#a6e22e>SIGNALENUM</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ENDFIELD</span>     <span style=color:#f92672>=</span> <span style=color:#a6e22e>EXIT</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>STATUS</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>SIGNAL</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ENDSEQ</span>       <span style=color:#f92672>=</span> <span style=color:#a6e22e>OSC</span> <span style=color:#ae81ff>&#34;3008;end=&#34;</span> <span style=color:#a6e22e>CTXID</span> <span style=color:#f92672>*</span>(<span style=color:#ae81ff>&#34;;&#34;</span> <span style=color:#a6e22e>ENDFIELD</span>) <span style=color:#a6e22e>ST</span></span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div><a class="flex align-center" href=https://github.com/uapi-group/specifications/edit/main/specs/osc_context.md target=_blank rel="noopener edit"><img src=/specifications/icons/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><div class="flex flex-wrap justify-between"><span><a href=/specifications/specs/vmgenid/ class="flex align-center"><img src=/specifications/icons/backward.svg class=book-icon alt=Backward>
<span>UAPI.14 VMGenID</span>
</a></span><span></span></div><div class=book-comments></div><script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#use-cases>Use Cases</a></li><li><a href=#context-types>Context Types</a></li><li><a href=#semantics>Semantics</a></li><li><a href=#general-syntax>General Syntax</a></li><li><a href=#metadata-fields>Metadata Fields</a></li><li><a href=#processing-limits-security>Processing, Limits, Security</a></li><li><a href=#examples>Examples</a></li><li><a href=#syntax-in-abnf>Syntax in ABNF</a></li></ul></nav></div></aside></main></body></html>